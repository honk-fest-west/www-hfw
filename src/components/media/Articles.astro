---
import { notion, format_rich } from '@lib/notion';
import Notion from '@data/notion.yml';

const articles = await notion.databases
  .query({
    database_id: Notion.ARTICLES,
  })
  .then((res) => group_articles(res.results));

function group_articles(articles) {
  return articles.reduce((list, article) => {
    if (article.properties['Reference'].rich_text?.length > 0) {
      return [...list, format_rich(article.properties['Reference'].rich_text)];
    } else {
      return [...list];
    }
  }, []);
}
---

<ul class="content">
  {articles.map((article) => <li set:html={article} />)}
</ul>
